{
    "configuration": {
        "version": "1",
        "stateable_class": "Encounter"
    },
    "statemachine": {
        "Initial": {
            "initial": 1,
            "transitions": [
                {
                    "name": "encounter_create",
                    "to_state": "Scheduled",
                    "trigger": "COMMAND",
                    "condition_type": "ACTION",
                    "condition": [
                        {
                            "name": "encounter_data_is_required",
                            "type": "PHP",
                            "ref": "EncounterDataRequired"
                        },
                        {
                            "name": "user_is_attendee",
                            "type": "PHP",
                            "ref": "UserIsAttendee"
                        }
                    ],
                    "action": [
                        {
                            "name": "queue_notification",
                            "type": "PHP",
                            "ref": "QueueNotification"
                        }
                    ]
                }
            ]
        },
        "Scheduled": {
            "initial": 0,
            "transitions": [
                {
                    "name": "encounter_accept",
                    "to_state": "Scheduled",
                    "trigger": "COMMAND",
                    "condition_type": "ACTION",
                    "condition": [
                        {
                            "name": "encounter_data_is_required",
                            "type": "PHP",
                            "ref": "EncounterDataRequired"
                        },
                        {
                            "name": "user_is_attendee",
                            "type": "PHP",
                            "ref": "UserIsAttendee"
                        }
                    ],
                    "action": [
                        {
                            "name": "queue_notification",
                            "type": "PHP",
                            "ref": "QueueNotification"
                        }
                    ]
                },
                {
                    "name": "encounter_re_schedule",
                    "to_state": "Scheduled",
                    "trigger": "COMMAND",
                    "condition_type": "ACTION",
                    "condition": [
                        {
                            "name": "encounter_data_is_required",
                            "type": "PHP",
                            "ref": "EncounterDataRequired"
                        },
                        {
                            "name": "user_is_original_attendee",
                            "type": "PHP",
                            "ref": "UserIsOriginalAttendee"
                        }
                    ],
                    "action": [
                        {
                            "name": "queue_notification",
                            "type": "PHP",
                            "ref": "QueueNotification"
                        }
                    ]
                },
                {
                    "name": "encounter_auto_re_schedule",
                    "to_state": "Pending Auto Re-scheduling",
                    "trigger": "COMMAND",
                    "condition_type": "ACTION",
                    "condition": [
                        {
                            "name": "encounter_data_is_required",
                            "type": "PHP",
                            "ref": "EncounterDataRequired"
                        }
                    ],
                    "action": [
                        {
                            "name": "queue_notification",
                            "type": "PHP",
                            "ref": "QueueNotification"
                        }
                    ]
                },
                {
                    "name": "encounter_finish",
                    "to_state": "Finished",
                    "trigger": "COMMAND",
                    "condition_type": "ACTION",
                    "condition": [
                        {
                            "name": "encounter_data_is_required",
                            "type": "PHP",
                            "ref": "EncounterDataRequired"
                        }
                    ],
                    "action": [
                        {
                            "name": "queue_notification",
                            "type": "PHP",
                            "ref": "QueueNotification"
                        }
                    ]
                },
                {
                    "name": "encounter_administrator_cancel",
                    "to_state": "Cancelled",
                    "trigger": "COMMAND",
                    "condition_type": "ACTION",
                    "condition": [
                        {
                            "name": "encounter_data_is_required",
                            "type": "PHP",
                            "ref": "EncounterDataRequired"
                        },
                        {
                            "name": "user_is_admin",
                            "type": "PHP",
                            "ref": "UserIsAdmin"
                        }
                    ],
                    "action": [
                        {
                            "name": "queue_notification",
                            "type": "PHP",
                            "ref": "QueueNotification"
                        }
                    ]
                },
                {
                    "name": "encounter_agent_cancel",
                    "to_state": "Cancelled",
                    "trigger": "COMMAND",
                    "condition_type": "ACTION",
                    "condition": [
                        {
                            "name": "encounter_data_is_required",
                            "type": "PHP",
                            "ref": "EncounterDataRequired"
                        },
                        {
                            "name": "user_is_assigned_agent",
                            "type": "PHP",
                            "ref": "UserIsAssignedAgent"
                        }
                    ],
                    "action": [
                        {
                            "name": "queue_notification",
                            "type": "PHP",
                            "ref": "QueueNotification"
                        }
                    ]
                },
                {
                    "name": "encounter_original_attendee_cancel",
                    "to_state": "Cancelled",
                    "trigger": "COMMAND",
                    "condition_type": "ACTION",
                    "condition": [
                        {
                            "name": "encounter_data_is_required",
                            "type": "PHP",
                            "ref": "EncounterDataRequired"
                        },
                        {
                            "name": "user_is_original_attendee",
                            "type": "PHP",
                            "ref": "UserIsOriginalAttendee"
                        }
                    ],
                    "action": [
                        {
                            "name": "queue_notification",
                            "type": "PHP",
                            "ref": "QueueNotification"
                        }
                    ]
                }
            ]
        },
        "Pending Auto Re-scheduling": {
            "initial": 0,
            "transitions": [
                {
                    "name": "encounter_re_schedule",
                    "to_state": "Scheduled",
                    "trigger": "COMMAND",
                    "condition_type": "ACTION",
                    "condition": [
                        {
                            "name": "encounter_data_is_required",
                            "type": "PHP",
                            "ref": "EncounterDataRequired"
                        }
                    ],
                    "action": [
                        {
                            "name": "queue_notification",
                            "type": "PHP",
                            "ref": "QueueNotification"
                        }
                    ]
                },
                {
                    "name": "encounter_escalate",
                    "to_state": "Pending Manual Re-scheduling",
                    "trigger": "COMMAND",
                    "condition_type": "ACTION",
                    "condition": [
                        {
                            "name": "encounter_data_is_required",
                            "type": "PHP",
                            "ref": "EncounterDataRequired"
                        }
                    ],
                    "action": [
                        {
                            "name": "queue_notification",
                            "type": "PHP",
                            "ref": "QueueNotification"
                        }
                    ]
                }
            ]
        },
        "Pending Manual Re-scheduling": {
            "initial": 0,
            "transitions": [
                {
                    "name": "encounter_re_schedule",
                    "to_state": "Scheduled",
                    "trigger": "COMMAND",
                    "condition_type": "ACTION",
                    "condition": [
                        {
                            "name": "encounter_data_is_required",
                            "type": "PHP",
                            "ref": "EncounterDataRequired"
                        },
                        {
                            "name": "user_is_admin",
                            "type": "PHP",
                            "ref": "UserIsAdmin"
                        }
                    ],
                    "action": [
                        {
                            "name": "queue_notification",
                            "type": "PHP",
                            "ref": "QueueNotification"
                        }
                    ]
                }
            ]
        },
        "Cancelled": {
            "initial": 0,
            "transitions": []
        },
        "Finished": {
            "initial": 0,
            "transitions": []
        }
    }
}
